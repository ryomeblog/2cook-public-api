<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="tocook.dao.RoutineEatTblMapperImpl">
  <resultMap id="default" type="tocook.dto.RoutineEatTblDTO">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Mar 13 00:22:24 JST 2022.
    -->
    <id column="routine_eat_id" jdbcType="VARCHAR" property="routineEatId" />
    <result column="routine_id" jdbcType="VARCHAR" property="routineId" />
    <result column="cook_id" jdbcType="VARCHAR" property="cookId" />
    <result column="routine_day" jdbcType="SMALLINT" property="routineDay" />
    <result column="routine_time" jdbcType="SMALLINT" property="routineTime" />
    <result column="user_id" jdbcType="VARCHAR" property="userId" />
    <result column="update_datetime" jdbcType="DATE" property="updateDatetime" />
    <result column="version" jdbcType="SMALLINT" property="version" />
    <result column="cook_name" jdbcType="VARCHAR" property="cookName" />
    <result column="cook_process" jdbcType="VARCHAR" property="cookProcess" />
    <result column="cook_price" jdbcType="BIGINT" property="cookPrice" />
    <result column="cook_flg" jdbcType="VARCHAR" property="cookFlg" />
    <result column="cook_movie" jdbcType="VARCHAR" property="cookMovie" />
    <result column="cook_url" jdbcType="VARCHAR" property="cookUrl" />
  </resultMap>

  <select id="selectMaxId" resultType="java.lang.String">
    SELECT
      MAX(routine_eat_id) as routine_eat_id
    FROM
      routine_eat_tbl
    ;
  </select>

  <select id="selectById" resultMap="default">
    SELECT
      routine_eat_tbl.cook_food_id,
      routine_eat_tbl.food_name,
      routine_eat_tbl.others1,
      routine_eat_tbl.others2,
      routine_eat_tbl.others3,
      routine_eat_tbl.others4,
      routine_eat_tbl.others5,
      routine_eat_tbl.version,
      common_mst.common_value1
    FROM
      routine_eat_tbl
    INNER JOIN
      common_mst
    ON
      routine_eat_tbl.food_unit = common_mst.common_id
    WHERE
      cook_food_id = #{foodId}
    AND
      user_id = #{userId}
  </select>

  <select id="selectByRoutineId" resultMap="default">
    SELECT
      routine_eat_tbl.routine_eat_id,
      routine_eat_tbl.routine_id,
      routine_eat_tbl.cook_id,
      routine_eat_tbl.routine_day,
      routine_eat_tbl.routine_time,
      routine_eat_tbl.user_id,
      routine_eat_tbl.version,
      cook_mst.cook_name,
      cook_mst.cook_flg
    FROM
      routine_eat_tbl
    INNER JOIN
      cook_mst
    ON
      cook_mst.cook_id = routine_eat_tbl.cook_id
    WHERE
      routine_eat_tbl.routine_id = #{routineId}
  </select>

  <select id="selectListByRoutineId" resultMap="default">
    SELECT
      *
    FROM
      routine_eat_tbl
    WHERE
      routine_id = #{routineId}
    AND
      user_id = #{userId}
    ;
  </select>

  <insert id="insertBulk" parameterType="java.util.List">
    insert into routine_eat_tbl
    <trim prefix="(" suffix=")" suffixOverrides=",">
        routine_eat_id,
        routine_id,
        cook_id,
        routine_day,
        routine_time,
        user_id,
    </trim>
    values
    <foreach collection="routineEatList" item="re" separator=",">
      <trim prefix="(" suffix=")" suffixOverrides=",">
        #{re.routineEatId,jdbcType=VARCHAR},
        #{re.routineId,jdbcType=VARCHAR},
        #{re.cookId,jdbcType=VARCHAR},
        #{re.routineDay,jdbcType=SMALLINT},
        #{re.routineTime,jdbcType=SMALLINT},
        #{re.userId,jdbcType=VARCHAR},
      </trim>
    </foreach>
  </insert>

  <delete id="deleteByRoutineId" parameterType="java.lang.String">
    DELETE FROM
      routine_eat_tbl
    WHERE
      routine_id = #{routineId}
  </delete>

</mapper>
